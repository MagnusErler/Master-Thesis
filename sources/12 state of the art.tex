\section{State of the art} \label{sec:knowledge}
This section overviews the foundational knowledge vital for developing a product with the LR1110 chip. It aims to establish a solid understanding of the project's infrastructure and technologies, equipping the reader with the necessary tools and knowledge to work with the LR1110 effectively, and succinctly describe the used product design methodologies. 

\subsection{Communications protocols}
\subsubsection{Serial communication}
Serial communication is a broad term that refers to any form of data transmission in which bits are sent sequentially, one after the other, over a single communication channel, which encompasses various serial communication methods, including \ac{I2C}, \ac{USART}, \ac{SPI} and others. These methods may differ in protocol, hardware requirements, speed, and application.

\subsubsubsection*{Universal Synchronous and Asynchronous Receiver/Transmitter (USART)}
\ac{USART}, is a half-duplex, asynchronous interface, and a widely used serial communication interface employed in microcontrollers, embedded systems, and various electronic devices. \ac{USART} enables asynchronous, non-simultaneous (half-duplex) data transmission between devices via dedicated TX and RX lines and a shared ground without a shared clock signal. This allows for greater flexibility in communication between devices operating at different speeds and with varying clock characteristics. Moreover, its asynchronous operation simplifies hardware implementation, promotes cross-platform compatibility, and renders it cost-effective and straightforward to deploy \cite{UART1}, \cite{UART2}.

\subsubsubsection*{Serial Peripheral Interface (SPI)}
\ac{SPI} is a full-duplex, synchronous interface, and one of the most widely used between microcontroller and peripheral ICs such as sensors, ADCs, DACs, shift registers, SRAM, and others. It operates on a master-slave model, on a four-wire configuration, encompassing shared \ac{MOSI}, \ac{MISO}, and \ac{SCK} lines, complemented by individual \ac{SS} lines for each distinct device in a multi-slave environment.

Distinguished from the asynchronous nature of \ac{USART}, \ac{SPI}'s synchronous operation is characterised by using dedicated data lines alongside a clock signal to maintain synchronisation between transmitting and receiving entities. This synchronisation ensures precise timing for data exchange, enhancing communication reliability and efficiency, negating the overhead stemming from including start and stop bits with each transmitted byte, and the susceptibility to data corruption in mismatched baud rates between communicating devices.
Further differentiating \ac{SPI} is its full-duplex capability, which permits simultaneous transmission and reception of data, thereby optimising throughput and enhancing efficiency in data exchange.

Compared to \ac{USART}, \ac{SPI} boasts superior speed and supports multiple peripherals. However it still requires more signal lines (wires) than other communications methods, as each peripheral requires a \ac{SS} line, and communication remains centralised under the master device, precluding direct communication between peripheral devices \cite{SPI_analog}, \cite{SPI_sparkfun}, \cite{SPI_wiki}.

\subsubsection{Wi-Fi}
Wi-Fi is a part of a wireless network protocol based on the technical standard IEEE 802.11\footnote{\url{https://www.ieee802.org/11/}}. For most people, Wi-Fi is synonymous with wireless internet access. However, the LR1110 chip does not use Wi-Fi in its conventional role as a data conduit. Instead, it serves as a tool for geolocation through Wi-Fi sniffing, harnessing access point signals to determine the device location. This method is explained in section %\ref{indsæt ref}

\subsubsection{Global Navigation Satellite System (GNSS)}
\ac{GNSS} is the general term for any satellite constellations that orbit the Earth and provides radio-based positioning, navigation, and timing information to users worldwide. This information can be used for trilateration; determining the unknown position coordinates of a point of interest, which is described in section %\ref{indsæt ref}.
The most well-known constellation is the United States-operated \ac{GPS} \ac{GPS}. Other constellations are GLONASS from Russia, Galileo from the European Union, BeiDou from China, IRNSS from India and QZSS from Japan. The LR1110 chip is capable of receiving signals from both GPS and BeiDou satellites.
Because of the signal strength and distance to the satellites, geopositioning using GNSS is predominantly viable in outdoor environments.

More information about GNSS, if we need to write more:
\url{https://www.youtube.com/watch?v=FU_pY2sTwTA}
\url{https://www.youtube.com/watch?v=wCcARVbL_Dk}

%GNSS ID\\
%\ac{C/N0} is a metric used to quantify the strength of a satellite signal relative to the background noise in the receiver's environment. \ac{C/N0} is often expressed in decibels [\si{\dB}] and is a crucial parameter in determining the quality of the received satellite signal. A higher \ac{C/N0} value generally indicates a stronger and more reliable satellite signal, which is desirable for accurate positioning and navigation.

\subsubsection{Long Range/Wide-Area-Network (LoRa/LoRaWAN)}
\ac{LoRa}, is an open standard networking layer, that is particularly well-suited for the \ac{IOT} and other applications where devices need to transmit small amounts of data over long distances while operating on low power \cite{LoRaWAN_1_0}.

As shown in figure  other \ac{LPWAN} technologies exist, however as \ac{LoRa} is the only protocol the LR1110-chip implements at this point, it is chosen wireless communication protocol for this project.
Considerations around the communication protocol and the advantages and disadvantages of \ac{LoRa} versus protocols with similar purposes will be presented in section \textcolor{red}{indsæt reference}.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{figures/range_bandwidth.png}
    \caption{Plot showing bandwidth versus the range of different wireless communication technologies. Rework from: \url{https://www3.cs.stonybrook.edu/~mdasari/courses/cse570/lora.pdf}}
    \label{fig:LoRa_bandwidth_range}
\end{figure}

\subsubsubsection*{En overskrift}
\ac{LoRa} refers to the physical layer and the proprietary spread spectrum modulation technique developed by Semtech, while \ac{LoRaWAN} refers to the network layer that defines the communication protocol and system architecture, enabling devices to communicate with \ac{LoRa} gateways and network servers. \ac{LoRaWAN} specifies how data should be transmitted, how end devices authenticate themselves on the network, how messages are acknowledged, and how devices can go into low-power sleep mode to conserve energy.

\ac{LoRaWAN} supports different classes of devices, allowing for flexibility in applications requiring either periodic or event-driven data transmission.

\ac{DevEUI} (also known as ChipEUI) is like a \ac{MAC} address, a unique identifier for the device. It is a 64-bit number that is assigned to the device by the manufacturer. The \ac{DevEUI} is used to identify the device in the network and is used in the activation process. \ac{JoinEUI} (also known as AppEUI) is a 64-bit number that is used to identify the network server in the activation process. The \ac{AppKey} is a 128-bit number that is used to encrypt the messages between the device and the network server. The \ac{AppKey} is used in the activation process to derive the \ac{NwkSKey} and \ac{AppSKey}.


%https://www.loracloud.com/documentation/join_service?url=glossary.html#term-Join-Server

Fig.~\ref{fig:LoRa_bandwidth_range} shows the difference between Wi-Fi and \ac{BLE}, versus \ac{LoRa} and cellular signals, comparing the range of the signal travelling and the bandwidth of the signal.

\ac{LoRaWAN} communicates on different frequencies depending on where the device is located; EU: \SI{868}{\mega\hertz} and \SI{433}{\mega\hertz}, US: \SI{915}{\mega\hertz}, AS: \SI{430}{\mega\hertz}.

SKRIV OGSÅ OM PRIS OG GATEWAYS PÅ LORAWAN
Evt.indsæt billede af Topology. End nodes <-> Gateways (private or corporate) <-> Network server <-> Application server

\ac{SF}

\subsubsection{HTTP/REST API}
Måske vil skal skrive noget om dette

\subsection{The LoRaCloud ecosystem}
Join server
Modem \& geolocation services

\subsection{Geopositioning}
Geopositioning or geolocation is the process of determining or estimating the geographic position of an object \cite{ISO19130}. This can be done using many different methods, each with strengths and weaknesses regarding workload and accuracy. This thesis focuses on using Wi-Fi and \ac{GNSS} combined with Google\footnote{Google Geolocation API: \hangindent=2em \url{https://developers.google.com/maps/documentation/geolocation/overview}} and Semtechs Geolocation APIs \footnote{LoRa Cloud: \url{https://www.loracloud.com/}} to get a general location of the LR1110 chip.

%https://lora-developers.semtech.com/learn/hands-on-labs/build-end-to-end-solution-using-lorawan-and-loraedge/find-the-location-of-your-tracking-device/


"Google's Geolocation API is a service provided by Google that allows developers to retrieve the approximate geographical location of a device based on various factors, without necessarily relying on \ac{GPS}. Here's a basic overview of how it works:

\textbf{Request Submission}: The client (a web browser or a mobile app) sends a request to the Geolocation API endpoint with data about nearby Wi-Fi access points, cellular towers, or Bluetooth beacons that the device can detect. This data includes information like the \ac{MAC} addresses of Wi-Fi access points, cell tower IDs, signal strengths, and other relevant parameters.

\textbf{Data Processing}: Google's servers receive the request and analyse the data provided. They compare the received data against a vast database of known Wi-Fi access points, cell tower locations, and their corresponding geographical coordinates. Google continuously collects this data through its Street View cars, mobile mapping vans, and other sources, building a massive database of Wi-Fi and cell tower locations worldwide.

\textbf{Triangulation and Trilateration}: Using the information gathered from nearby Wi-Fi access points, cellular towers, and other available signals, Google's servers apply techniques like triangulation and trilateration to estimate the device's location. Triangulation involves determining the device's position by measuring the angles between it and known points (e.g., Wi-Fi access points). Trilateration involves calculating the device's position based on its distance from multiple known points.

\textbf{Response}: After processing the request and estimating the device's location, the Geolocation API returns a response containing the latitude and longitude coordinates of the device's approximate location. Additionally, the response may include other information such as the accuracy of the location estimate and a confidence radius.

\textbf{Privacy Considerations}: Google takes privacy seriously and implements measures to protect user privacy when using the Geolocation API. For example, the \ac{API} may not return precise location data in certain cases, and users have control over their location-sharing settings through their device settings and Google account preferences.

Overall, Google's Geolocation API provides a convenient and efficient way for developers to determine the approximate geographical location of a device without relying solely on \ac{GPS}, making it useful for a wide range of location-based applications and services."

%https://samy.pl/mapxss/
%https://developers.google.com/maps/documentation/geolocation/overview
%https://blog.invgate.com/how-to-locate-a-device-using-a-mac-address
%https://blog.semtech.com/indoor-wi-fi-geolocation-with-lora-edge
%https://lora-developers.semtech.com/community/faq/faq-geo-location
%https://lora-developers.semtech.com/learn/hands-on-labs/build-end-to-end-solution-using-lorawan-and-loraedge/find-the-location-of-your-tracking-device/

\subsubsection{GNSS positioning}

The LR1110 features a fast and low-power \ac{GNSS} scanner. The device captures a short portion of the signal broadcast by the
\ac{GNSS} satellites and extracts the information required to calculate the device position - the pseudo ranges. This information is aggregated into a \ac{NAV} which can be sent to a solver to compute the device position.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.9\textwidth]{figures/GNSS_scanning.png}
    \caption{GNSS Scanning Principle, Assisted Mode.}
    \label{fig:gnss_scanning}
\end{figure}
% taken from: https://semtech.my.salesforce.com/sfc/p/#E0000000JelG/a/3n000000vBus/cPXIY7jwqFWpmW7USMtfqpJt7T5afR439wbYefi4tsI page 17

Providing assistance information to the LR1110 will minimize the search space, reducing the capture time and the energy spent.

The \ac{GNSS} scanner of the LR1110 has two modes of operation: autonomous and assisted.

\subsubsubsection{Autonomous GNSS Scanning}
The LR1110 will not require any assistance information in this mode. A fast search of all \ac{SV}s with strong signals in the
selected constellation is performed, and all the \ac{SV}s received with a signal better than RXSGPS1E\footnote{RXSGPS1E: GPS, indoor classification, and strong signal SV capture. Typ. \SI{-134}{\dB}\cite{LR1110_datasheet}} are detected.
This mode can be used to determine if the device stands indoors or outdoors; in case no \ac{SV} with a strong signal is detected, the application concludes that the device is indoors. Therefore the search for weak signals, which takes more time and energy, can be discarded; the search for other signals of opportunity, like Wi-Fi, might be launched instead.

\subsubsubsection{Assisted GNSS Scanning}
Based on the assistance information, the LR1110 will build a list of 10 to 12 \ac{SV}s that it should look for at the position of the device and the actual time.
Two different assisted \ac{GNSS} scanning modes are implemented:
\begin{itemize}
\item \textbf{Low power}: A first search of strong signal satellites within the list of visible ones will be made. If at least one satellite is found in this step, the search will continue for satellites with weaker signals. Otherwise, the search will stop. This mode minimises energy consumption and can also be used as an indoor/ outdoor detection method, in a more efficient way than the autonomous \ac{GNSS} scanning mode. The indoor classification is decided after searching 10-12 \ac{SV}s, versus 32-35 in Autonomous scanning mode.
\item \textbf{Best effort}: A first search of \ac{SV}s with strong signals, within the list of visible satellites, is made. Even if no satellite is found in the first phase, the search continues for satellites with weaker signals. This mode is to be used in difficult environments where it may be possible to find \ac{SV}s, at the expense of a longer search phase.
\end{itemize}
The scanner uses a sequence of capture and processing phases. To reserve power, the \ac{RF} front end will be turned off during the processing phases.

\subsubsection{Wi-Fi positioning/Geolocation databases/API}
Semtech
Google
Apple, Qualcomm, Wiggle

\subsection{Product design}
A brief introduction to what product design is. Maybe how it has changed?

\subsubsection{Prototyping}




3D-printing
However, since interactive systems are complex, it may be difficult or impossible to create prototypes of a whole design in the formative stages of a project.
Choosing the right kind of more focused prototype to build is an art in itself, and communicating its limited purposes to its various audiences is a critical aspect of its use

This chapter aims to establish a model that describes any prototype in terms of the artifact being designed, rather than the prototype's incidental attributes. By focusing on the purpose of the prototype—that is, on what it prototypes

Prototypes provide the means for examining design problems and evaluating solutions. Selecting the focus of a prototype is the art of identifying the most important open design questions

Teksten ovenfra er fra Houde - What do Prototypes prototype?
Skriv om, hvordan prototyper kan teste forskellige ting, og hvordan opmærksomhed på dette inden, kan hjælpe med at få det rigtige udkom af ens prototype.

\subsubsection{Actor-oriented design}
Hvad er en fælles nævner for de forskellige etnografiske feltstudiemetoder?
Det er kvalitativ metode eftersom at dette er essentielt for design, da vi er interesserede i detaljer!

Hvad er induktiv tilgang?
Empirisk induktiv. Man starter med kvalitativ dataindsamling, man finder heraf en induktiv slutning og ser heraf en sammenhæng eller et mønster.
Fx. I et givet tidsrum på et bestemt sted er alle fugle sorte, og man konkluderer heraf at alle fugle er sorte

Hvad er Grounded Theory, samt hvilken tilgang?
Induktiv. En design-ingeniørs måde hvorpå at være undersøgende og starte fra bunden -> vi starter i empirien.
Problemet defineres på baggrund af den data der indsamles. En analyse kan vise mønstre af tematikker.

Hvad hører sammen med kvalitativ data?
Induktiv! Videnskabelig metode som ikke er målbar.

Interviews - Etnografisk felstudie
Hvad er en fælles nævner for de forskellige etnografiske feltstudiemetoder?
Det er kvalitativ metode eftersom at dette er essentielt for design, da vi er interesserede i detaljer!

Hvilken tilgang skal vi helst bruge som design-ingeniører? - Induktiv

Hvad er et etnografisk interview?
Det er en kvalitativ metode.
Et åbent interview hvor man kommer tættere på aktørens kultur og praksis.
Man gør sig fremmed for det felt man undersøger.
Iterativt -> kræver en analyse som ofte leder op til et nyt feltbesøg.

Hvad skal man have med når man forbereder sig til interviews?
Hvilken viden mangler vi?
Hvem ligger inde med den?
Hvem tager vi kontakt til? Hvordan tager vi kontakten?
Hvem faciliterer interviewet?
Hvordan dokumenterer vi undervejs?
Hvor udfører vi interviewet? (on location eller ....?)
Hvordan deler vi viden efterfølgende (optager vi samtalen, skriver vi noter, laver vi arbejdsblade?)

Hvad er et affinitetsdiagram, overordnet?
At gruppere viden (KJ-metoden)
Deling af viden i teamet, fra forskellige kilder.
Fortolkning af viden, analyse.

Skriv ting på post-its og grupper efterfølgende i overordnede temaer.

Hvad tager affinitetsdiagrammer udgangspunkt i?
Grounded theory; derfor, lad empirien tale -vundgå prædefinerede kategorier.
Start med statements/findings og IKKE med overskrifterne.

\subsubsection{Design criteria}
How to set up design criteria.
Here, we must talk about requirements, criteria and wishes.
Requirements are things that must be
Criteria are measurable. This means that they can be more or less fulfilled.
Wishes are nice to have

\subsubsection{Use cases}
How do you find use cases? What are use cases?

\subsubsection{Affinity diagram/KJ-method}
Affinity: a similarity of characteristics suggesting a relationship, especially a resemblance in structures and thoughts.
Affinity mapping gives designers a visual view of their research, capturing data so that themes, trends, and needs emerge.
Affinity mapping is done during the divergent research phase. In this diagram of the Double Diamond, where the first diamond to the left represents research discovery and analysis, affinity mapping can be done multiple times to organise and analyse research data. At the beginning of the design phase, represented by the second diamond on the right, research should be finalised. It is not recommended to do affinity mapping during the design phase.